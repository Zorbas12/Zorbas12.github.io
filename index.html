<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Φούρνοι Ζορπάς</title>
<style>
  body {margin:0;font-family:Arial,sans-serif;background-color:#DAD9D7;position:relative;height:100vh;overflow-x:hidden;}
  #mainFormSection,#noPermissionSection,#adminGuiSection,#submissionsGuiSection,#consoleGuiSection{display:none;flex-direction:column;align-items:center;justify-content:center;height:100vh;}
  .language-switcher{position:absolute;top:10px;right:10px;display:flex;gap:10px;}
  .language-switcher button{padding:5px 10px;font-size:14px;border-radius:5px;border:1px solid #ccc;cursor:pointer;background-color:#E4D882;font-weight:bold;}
  .language-switcher button:hover{background-color:#CFC76D;}
  h1{font-family:'Algerian',serif;font-size:48px;color:#333;margin-bottom:30px;text-align:center;}
  form,#adminGuiSection .admin-gui-box,#submissionsGuiSection,#consoleGuiSection .console-box{display:flex;flex-direction:column;gap:20px;text-align:center;}
  form,#adminGuiSection .admin-gui-box{background-color:#fff;padding:30px;border-radius:15px;width:350px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
  form>div,#adminGuiSection .admin-gui-box>div,#submissionsGuiSection>div,#consoleGuiSection .console-box>div{display:flex;flex-direction:column;align-items:center;justify-content:center;}
  label{font-weight:bold;margin-bottom:5px;}
  input,select,button{padding:10px;font-size:16px;border-radius:8px;border:1px solid #ccc;width:80%;box-sizing:border-box;}
  button[type="submit"]{background-color:#E4D882;font-weight:bold;}
  button[type="submit"]:hover{background-color:#CFC76D;}
  .admin-buttons{position:fixed;bottom:20px;right:20px;display:none;gap:10px;}
  .admin-buttons button{padding:10px 15px;font-size:14px;border-radius:5px;border:1px solid #ccc;cursor:pointer;background-color:#E4D882;font-weight:bold;}
  .admin-buttons button:hover{background-color:#CFC76D;}
  .success-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#4BB543;color:white;padding:25px 40px;border-radius:12px;font-size:20px;font-weight:bold;box-shadow:0 0 15px rgba(0,0,0,0.2);opacity:0;pointer-events:none;transition:opacity 0.5s ease;z-index:1005;}
  .success-message.show{opacity:1;pointer-events:auto;}
  #adminGuiSection,#consoleGuiSection{position:fixed;top:0;left:0;width:100%;height:100vh;background-color:rgba(0,0,0,0.1);align-items:center;justify-content:center;z-index:1003;}
  #submissionsGuiSection{flex-direction:column;align-items:center;justify-content:flex-start;width:100%;padding:20px;background-color:#DAD9D7;min-height:100vh;box-sizing:border-box;z-index:1001;}
  #adminGuiSection .admin-gui-box,#consoleGuiSection .console-box{background-color:#fff;padding:40px 60px;border-radius:15px;display:flex;flex-direction:column;align-items:center;gap:25px;box-shadow:0 5px 20px rgba(0,0,0,0.2);text-align:center;}
  #adminGuiSection .admin-gui-box h1,#consoleGuiSection .console-box h1{font-size:36px;margin-bottom:20px;}
  #adminGuiSection .admin-gui-box button,#consoleGuiSection .console-box button{width:250px;padding:15px 0;font-size:18px;border-radius:10px;border:none;cursor:pointer;background-color:#E4D882;font-weight:bold;transition:0.3s;}
  #adminGuiSection .admin-gui-box button:hover,#consoleGuiSection .console-box button:hover{background-color:#CFC76D;}
  #consoleLog{background:#fff;color:#000;padding:15px;width:400px;height:300px;overflow-y:auto;border-radius:10px;text-align:left;font-family:monospace;font-size:14px;border:2px solid black;}
  #consoleInput{background:#fff;color:#000;padding:8px;margin-top:10px;border-radius:5px;border:1px solid #ccc;width:90%;}
  #noPermissionSection{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;z-index:1000;}
  #noPermissionSection h1{font-size:48px;margin-bottom:20px;text-shadow:2px 2px 5px black;}
  @media (max-width:640px){
    h1{font-size:34px;}
    #mainFormSection form, #adminGuiSection .admin-gui-box{width:90%;}
  }
</style>
</head>
<body>

<div class="language-switcher">
  <button id="englishBtn">English</button>
  <button id="greekBtn">Greek</button>
</div>

<div id="noPermissionSection">
  <h1>You do not have permission to access this website</h1>
</div>

<div id="mainFormSection">
  <h1>Zorbas Submissions</h1>
  <form id="submissionForm">
    <div>
      <label for="name" id="nameLabel"><strong>Name</strong></label>
      <input type="text" id="name" required placeholder="Enter your name">
    </div>
    <div>
      <label for="month" id="monthLabel">Month</label>
      <select id="month" required><option value="">Select Month</option></select>
    </div>
    <div>
      <label for="day" id="dayLabel"><strong>Day</strong></label>
      <input type="text" id="day" class="type-input" placeholder="Type day" required>
    </div>
    <div>
      <label for="shift" id="shiftLabel">Shift</label>
      <select id="shift" required><option value="">Select Shift</option></select>
    </div>
    <div>
      <label for="store" id="storeLabel">Store</label>
      <select id="store" required><option value="">Select Store</option></select>
    </div>
    <div>
      <button type="submit" id="submitBtn">Submit</button>
    </div>
  </form>
</div>

<div id="adminGuiSection">
  <div class="admin-gui-box">
    <h1>Admin GUI</h1>
    <button id="resetAllBtn">Reset All Submissions</button>
    <button id="backBtn">Back</button>
  </div>
</div>

<div id="submissionsGuiSection">
  <h1>Pending Submissions</h1>
  <div id="submissionsList"></div>
  <button id="backFromSubmissionsBtn">Back</button>
</div>

<div id="consoleGuiSection">
  <div class="console-box">
    <h1>Console</h1>
    <div id="consoleLog"></div>
    <input type="text" id="consoleInput" placeholder="Type command: adminadd {deviceID} / adminremove {deviceID} / add {deviceID} / remove {deviceID}">
    <button id="backFromConsoleBtn">Back</button>
  </div>
</div>

<div class="admin-buttons" id="adminButtons">
  <button id="adminGuiBtn">Admin GUI</button>
  <button id="consoleBtn">Console</button>
</div>

<div class="success-message" id="successMessage">You have successfully submitted!</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

  const monthSelect=document.getElementById('month');
  const shiftSelect=document.getElementById('shift');
  const storeSelect=document.getElementById('store');
  const dayInput=document.getElementById('day');
  const englishBtn=document.getElementById('englishBtn');
  const greekBtn=document.getElementById('greekBtn');
  const consoleLog=document.getElementById('consoleLog');
  const consoleInput=document.getElementById('consoleInput');
  const adminButtonsDiv=document.getElementById('adminButtons');
  const mainFormSection=document.getElementById('mainFormSection');
  const adminGuiSection=document.getElementById('adminGuiSection');
  const submissionsGuiSection=document.getElementById('submissionsGuiSection');
  const consoleGuiSection=document.getElementById('consoleGuiSection');
  const successMessage=document.getElementById('successMessage');
  const noPermissionSection=document.getElementById('noPermissionSection');

  const monthDays={January:31,February:28,March:31,April:30,May:31,June:30,July:31,August:31,September:30,October:31,November:30,December:31};

  let admins=JSON.parse(localStorage.getItem('admins')||'[]');
  let pendingSubmissions=JSON.parse(localStorage.getItem('pendingSubmissions')||"[]");
  let allowedUsers=JSON.parse(localStorage.getItem('allowedUsers')||"[]");

  let deviceName = localStorage.getItem('deviceName') || "Raphael";
  let storedDeviceId = localStorage.getItem('deviceId');
  let deviceId;
  if(storedDeviceId){
    deviceId = storedDeviceId;
  } else {
    deviceId = (Math.floor(Math.random() * 900000000) + 100000000).toString();
    localStorage.setItem('deviceId', deviceId);
  }
  localStorage.setItem('deviceName', deviceName);

  function logConsoleEvent(msg){
    const entry=document.createElement('div');
    entry.innerText=msg;
    consoleLog.appendChild(entry);
    consoleLog.scrollTop=consoleLog.scrollHeight;
  }

  logConsoleEvent(`<${deviceName}> opened the app #${deviceId}`);

  function setLanguage(lang){
    document.getElementById('nameLabel').innerHTML=`<strong>${lang==='greek'?'Όνομα':'Name'}</strong>`;
    document.getElementById('name').placeholder=lang==='greek'?'Εισάγετε το όνομά σας':'Enter your name';
    const months = lang==='greek'?["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"]:Object.keys(monthDays);
    monthSelect.innerHTML=`<option value="">${lang==='greek'?'Επιλέξτε Μήνα':'Select Month'}</option>`+months.map(m=>`<option>${m}</option>`).join('');
    document.getElementById('dayLabel').innerHTML=`<strong>${lang==='greek'?'Ημέρα':'Day'}</strong>`;
    document.getElementById('day').placeholder=lang==='greek'?'Πληκτρολογήστε την ημέρα':'Type day';
    shiftSelect.innerHTML=`<option value="">${lang==='greek'?'Επιλέξτε Βάρδια':'Select Shift'}</option>`+(lang==='greek'?["Άδεια","6-2","2-10"]:["Off","6-2","2-10"]).map(s=>`<option>${s}</option>`).join('');
    storeSelect.innerHTML=`<option value="">${lang==='greek'?'Επιλέξτε Κατάστημα':'Select Store'}</option>`+Array.from({length:26},(_,i)=>String.fromCharCode(65+i)).map(l=>`<option>${l}</option>`).join('');
    document.getElementById('submitBtn').innerText=lang==='greek'?'Υποβολή':'Submit';
  }

  englishBtn.addEventListener('click',()=>setLanguage('english'));
  greekBtn.addEventListener('click',()=>setLanguage('greek'));
  setLanguage('english');

  dayInput.addEventListener("input",()=>{dayInput.value=dayInput.value.replace(/[^0-9\- ]/g,"");});
  monthSelect.addEventListener('change',()=>{const max=monthDays[monthSelect.value]||31;if(/^\d+$/.test(dayInput.value)&&parseInt(dayInput.value)>max) dayInput.value=max;});

  document.getElementById('submissionForm').addEventListener('submit',e=>{
    e.preventDefault();
    if(e.target.checkValidity()){
      const playerName=document.getElementById('name').value;
      pendingSubmissions.push({name:playerName,month:monthSelect.value,day:dayInput.value,shift:shiftSelect.value,store:storeSelect.value});
      localStorage.setItem('pendingSubmissions',JSON.stringify(pendingSubmissions));
      logConsoleEvent(`<${deviceName} #${deviceId}> submitted: ${playerName}`);
      successMessage.classList.add('show');
      setTimeout(()=>successMessage.classList.remove('show'),3000);
      e.target.reset();
    }
  });

  function updateAdminButtonsVisibility(){
    const isAdmin = admins.includes(deviceId.toString());
    adminButtonsDiv.style.display = isAdmin ? 'flex' : 'none';
  }

  function checkPermission(){
    if(!admins.includes(deviceId.toString())){
      showSection(noPermissionSection);
    } else {
      showSection(mainFormSection);
    }
    updateAdminButtonsVisibility();
  }

  function showSection(section){
    mainFormSection.style.display='none';
    adminGuiSection.style.display='none';
    submissionsGuiSection.style.display='none';
    consoleGuiSection.style.display='none';
    noPermissionSection.style.display='none';
    section.style.display='flex';
    updateAdminButtonsVisibility();
  }

  checkPermission();

  document.getElementById('adminGuiBtn').addEventListener('click',()=>showSection(adminGuiSection));
  document.getElementById('consoleBtn').addEventListener('click',()=>showSection(consoleGuiSection));

  document.getElementById('resetAllBtn').addEventListener('click',()=>{
    pendingSubmissions=[];
    localStorage.setItem('pendingSubmissions',JSON.stringify(pendingSubmissions));
    logConsoleEvent(`<${deviceName} #${deviceId}> reset all submissions`);
  });

  document.getElementById('backBtn').addEventListener('click',()=>showSection(mainFormSection));
  document.getElementById('backFromConsoleBtn').addEventListener('click',()=>showSection(mainFormSection));
  document.getElementById('backFromSubmissionsBtn').addEventListener('click',()=>showSection(adminGuiSection));

  // Add yourself as admin
  window.addAdmin = function(){
    if(!admins.includes(deviceId)){
      admins.push(deviceId);
      localStorage.setItem('admins',JSON.stringify(admins));
      updateAdminButtonsVisibility();
      console.log(`Device ${deviceId} is now admin`);
    }
  }

  // Console input
  consoleInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter'){
      const input = consoleInput.value.trim();
      if(!input) return;
      logConsoleEvent(`> ${input}`);
      const [cmd, id] = input.split(' ');

      switch(cmd){
        case 'adminadd':
          if(id && !admins.includes(id)){
            admins.push(id);
            localStorage.setItem('admins', JSON.stringify(admins));
            logConsoleEvent(`Added admin: ${id}`);
            updateAdminButtonsVisibility();
          }
          break;
        case 'adminremove':
          if(id){
            admins = admins.filter(a=>a!==id);
            localStorage.setItem('admins', JSON.stringify(admins));
            logConsoleEvent(`Removed admin: ${id}`);
            updateAdminButtonsVisibility();
          }
          break;
        case 'add':
          if(id && !allowedUsers.includes(id)){
            allowedUsers.push(id);
            localStorage.setItem('allowedUsers', JSON.stringify(allowedUsers));
            logConsoleEvent(`Added allowed user: ${id}`);
          }
          break;
        case 'remove':
          if(id){
            allowedUsers = allowedUsers.filter(a=>a!==id);
            localStorage.setItem('allowedUsers', JSON.stringify(allowedUsers));
            logConsoleEvent(`Removed allowed user: ${id}`);
          }
          break;
        default:
          logConsoleEvent(`Unknown command: ${cmd}`);
      }
      consoleInput.value = '';
    }
  });

});
</script>
</body>
</html>
